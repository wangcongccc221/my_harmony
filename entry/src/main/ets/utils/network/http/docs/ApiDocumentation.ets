import { HttpResponseUtils } from '../../../helpers/HttpResponseUtils';

/**
 * APIæ¥å£æ–‡æ¡£ç”Ÿæˆå™¨
 * ç”¨äºç”Ÿæˆå†å²åŠ å·¥æ•°æ®è¡¨çš„APIæ–‡æ¡£HTMLé¡µé¢
 */
export class ApiDocumentation {
  /**
   * è·å–APIæ–‡æ¡£é¡µé¢å“åº”
   */
  static getApiDocsResponse(): string {
    const htmlContent = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>APIæ¥å£æ–‡æ¡£ - å†å²åŠ å·¥æ•°æ®è¡¨</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --primary:#667eea; --bg:#f5f6fa; --card:#ffffff; --muted:#6b7280; }
    body { font-family: "HarmonyOS Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif; background: var(--bg); line-height: 1.6; }
    .topnav { position: sticky; top:0; background: var(--primary); color:#fff; display:flex; align-items:center; justify-content:space-between; padding:12px 20px; }
    .brand { font-weight:600; letter-spacing:.3px; }
    .links a { color:#fff; text-decoration:none; margin-left:16px; padding:6px 10px; border-radius:6px; }
    .links a:hover { background: rgba(255,255,255,.18); }
    .container { max-width: 1000px; margin: 24px auto; background: var(--card); border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.08); padding: 32px; }
    h1 { color: #333; margin-bottom: 10px; font-size: 32px; }
    .subtitle { color: #666; margin-bottom: 30px; font-size: 16px; }
    h2 { color: #444; margin-top: 40px; margin-bottom: 20px; font-size: 24px; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
    h3 { color: #555; margin-top: 25px; margin-bottom: 15px; font-size: 18px; }
    .api-item { background: #f8f9fa; border-left: 4px solid #667eea; padding: 20px; margin-bottom: 20px; border-radius: 8px; }
    .method { display: inline-block; background: #667eea; color: white; padding: 4px 12px; border-radius: 4px; font-weight: bold; font-size: 14px; margin-right: 10px; }
    .endpoint { font-family: monospace; font-size: 16px; color: #333; margin: 10px 0; }
    .params { margin-top: 15px; }
    .param-item { margin: 8px 0; padding-left: 20px; }
    .param-name { font-family: monospace; color: #667eea; font-weight: bold; }
    .param-desc { color: #666; margin-left: 10px; }
    .required { color: #e74c3c; font-weight: bold; }
    code { background: #f1f3f5; padding: 2px 6px; border-radius: 4px; font-family: monospace; font-size: 14px; }
    pre { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 8px; overflow-x: auto; margin: 15px 0; }
    .example { background: #e8f4f8; border-left: 4px solid #3498db; padding: 15px; margin: 15px 0; border-radius: 4px; }
    .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 15px 0; border-radius: 4px; }
    a { color: #667eea; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <nav class="topnav">
    <div class="brand"></div>
    <div class="links">
      <a href="/">é¦–é¡µ</a>
      <a href="/api/docs">API æ–‡æ¡£</a>
      <a href="/api/status">æœåŠ¡å™¨çŠ¶æ€</a>
    </div>
  </nav>
  <div class="container">
    <h1>ğŸ“š APIæ¥å£æ–‡æ¡£</h1>
    <p class="subtitle">å†å²åŠ å·¥æ•°æ®è¡¨ - ç¬¬ä¸‰æ–¹ç³»ç»Ÿè®¿é—®æ¥å£</p>
    
    <div class="note">
      <strong>ğŸ’¡ æç¤ºï¼š</strong> æœåŠ¡å™¨åœ°å€é€šå¸¸æ˜¯ <code>http://[è®¾å¤‡IP]:8080</code> æˆ– <code>http://localhost:8080</code><br>
      å¦‚æœè¿æ¥ä¸ä¸Šï¼Œå…ˆæ‰§è¡Œç«¯å£æ˜ å°„ï¼š<code>hdc fport tcp:8080 tcp:8080</code>
    </div>

    <h2>1ï¸âƒ£ è·å–å†å²åŠ å·¥æ•°æ®åˆ—è¡¨ï¼ˆRESTful é£æ ¼ï¼Œæ”¯æŒåˆ†é¡µï¼‰</h2>
    <div class="api-item">
      <span class="method">GET</span>
      <span class="endpoint">/api/processing</span>
      <p style="margin-top: 15px; color: #666;">è·å–å†å²åŠ å·¥è®°å½•åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢</p>
      
      <h3>æŸ¥è¯¢å‚æ•°ï¼š</h3>
      <div class="params">
        <div class="param-item">
          <span class="param-name">page</span>
          <span class="param-desc">é¡µç ï¼Œä»1å¼€å§‹ï¼ˆé»˜è®¤ï¼š1ï¼‰</span>
        </div>
        <div class="param-item">
          <span class="param-name">size</span>
          <span class="param-desc">æ¯é¡µæ•°é‡ï¼Œæœ€å¤§100ï¼ˆé»˜è®¤ï¼š20ï¼‰</span>
        </div>
      </div>
      
      <h3>è¯·æ±‚ç¤ºä¾‹ï¼š</h3>
      <div class="example">
        <strong>è·å–ç¬¬ä¸€é¡µï¼ˆ20æ¡ï¼‰ï¼š</strong>
        <pre>fetch('http://localhost:8080/api/processing?page=1&size=20')
  .then(res => res.json())
  .then(data => console.log(data));</pre>
      </div>
      
      <div class="example">
        <strong>curlå‘½ä»¤ï¼š</strong>
        <pre>curl "http://localhost:8080/api/processing?page=1&size=20"</pre>
      </div>

      <h3>è¿”å›æ•°æ®æ ¼å¼ï¼š</h3>
      <pre>{
  "ok": true,
  "data": {
    "data": [
      {
        "id": 1,
        "customerName": "å®¢æˆ·A",
        "farmName": "å†œåœºB",
        "fruitName": "è‹¹æœ",
        "status": "å·²å®Œæˆ",
        "startTime": "2025-11-08 11:40",
        "endTime": "2025-11-11 11:40",
        "weight": 123,
        "count": 123,
        "productType": "è‹¹æœ",
        "totalWeight": 123
      }
    ],
    "pagination": {
      "page": 1,
      "size": 20,
      "total": 100,
      "totalPages": 5
    }
  }
}</pre>
    </div>

    <div class="note" style="margin-top: 20px;">
      <strong>ğŸ’¡ å…¼å®¹æ—§ç‰ˆæœ¬ï¼š</strong> ä»æ”¯æŒ <code>GET /api/processing?action=listJson</code> è·å–æ‰€æœ‰æ•°æ®ï¼ˆæ— åˆ†é¡µï¼‰
    </div>

    <h2>2ï¸âƒ£ åˆ›å»ºæ–°çš„åŠ å·¥è®°å½•ï¼ˆRESTful é£æ ¼ï¼‰</h2>
    <div class="api-item">
      <span class="method">POST</span>
      <span class="endpoint">/api/processing</span>
      <p style="margin-top: 15px; color: #666;">åˆ›å»ºä¸€æ¡æ–°çš„å†å²åŠ å·¥è®°å½•ï¼Œæ”¯æŒ JSON è¯·æ±‚ä½“</p>
      
      <h3>è¯·æ±‚å‚æ•°ï¼ˆJSON Body æˆ– Query Stringï¼‰ï¼š</h3>
      <div class="params">
        <div class="param-item">
          <span class="param-name">startTime</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">å¼€å§‹æ—¶é—´ï¼Œæ ¼å¼ï¼š2025-11-08T11:40 æˆ– 2025-11-08 11:40:00</span>
        </div>
        <div class="param-item">
          <span class="param-name">endTime</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">ç»“æŸæ—¶é—´ï¼Œæ ¼å¼ï¼š2025-11-11T11:40 æˆ– 2025-11-11 11:40:00</span>
        </div>
        <div class="param-item">
          <span class="param-name">fruitName</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">æ°´æœåç§°</span>
        </div>
        <div class="param-item">
          <span class="param-name">weight</span> æˆ– <span class="param-name">totalWeight</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">é‡é‡ï¼ˆåƒå…‹ï¼‰ï¼Œè‡³å°‘å¡«ä¸€ä¸ª</span>
        </div>
        <div class="param-item">
          <span class="param-name">customerName</span>
          <span class="param-desc">å®¢æˆ·åç§°ï¼ˆå¯é€‰ï¼‰</span>
        </div>
        <div class="param-item">
          <span class="param-name">farmName</span>
          <span class="param-desc">å†œåœºåç§°ï¼ˆå¯é€‰ï¼‰</span>
        </div>
        <div class="param-item">
          <span class="param-name">status</span>
          <span class="param-desc">çŠ¶æ€ï¼Œå¦‚ï¼šå·²å®Œæˆã€è¿›è¡Œä¸­ã€å¾…å¼€å§‹ï¼ˆå¯é€‰ï¼‰</span>
        </div>
        <div class="param-item">
          <span class="param-name">count</span>
          <span class="param-desc">æ•°é‡ï¼ˆæ•´æ•°ï¼Œå¯é€‰ï¼‰</span>
        </div>
      </div>

      <h3>è¯·æ±‚ç¤ºä¾‹ï¼ˆJSON Bodyï¼Œæ¨èï¼‰ï¼š</h3>
      <div class="example">
        <strong>JavaScript (fetch)ï¼š</strong>
        <pre>fetch('http://localhost:8080/api/processing', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    startTime: '2025-11-08T11:40',
    endTime: '2025-11-11T11:40',
    fruitName: 'è‹¹æœ',
    weight: 123,
    customerName: 'å®¢æˆ·A',
    farmName: 'å†œåœºB',
    status: 'å·²å®Œæˆ',
    count: 123
  })
})
  .then(res => res.json())
  .then(data => console.log('æ·»åŠ æˆåŠŸ:', data));</pre>
      </div>

      <div class="example">
        <strong>curlå‘½ä»¤ï¼ˆJSONï¼‰ï¼š</strong>
        <pre>curl -X POST http://localhost:8080/api/processing \\
  -H "Content-Type: application/json" \\
  -d '{"startTime":"2025-11-08T11:40","endTime":"2025-11-11T11:40","fruitName":"è‹¹æœ","weight":123,"customerName":"å®¢æˆ·A","farmName":"å†œåœºB","status":"å·²å®Œæˆ","count":123}'</pre>
      </div>
    </div>

    <div class="note" style="margin-top: 20px;">
      <strong>ğŸ’¡ å…¼å®¹æ—§ç‰ˆæœ¬ï¼š</strong> ä»æ”¯æŒ <code>POST /api/processing?action=insert&...</code> é€šè¿‡ Query String ä¼ å‚
    </div>

    <h2>3ï¸âƒ£ æ›´æ–°åŠ å·¥è®°å½•ï¼ˆRESTful é£æ ¼ï¼‰</h2>
    <div class="api-item">
      <span class="method">PUT</span>
      <span class="endpoint">/api/processing/:id</span>
      <p style="margin-top: 15px; color: #666;">æ›´æ–°æŒ‡å®šIDçš„åŠ å·¥è®°å½•ï¼ˆåªä¼ è¦ä¿®æ”¹çš„å­—æ®µï¼‰</p>
      
      <h3>è·¯å¾„å‚æ•°ï¼š</h3>
      <div class="params">
        <div class="param-item">
          <span class="param-name">id</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">è®°å½•IDï¼ˆåœ¨URLè·¯å¾„ä¸­ï¼‰</span>
        </div>
      </div>

      <h3>è¯·æ±‚å‚æ•°ï¼ˆJSON Bodyï¼Œåªä¼ è¦ä¿®æ”¹çš„å­—æ®µï¼‰ï¼š</h3>
      <div class="params">
        <div class="param-item">
          <span class="param-name">customerName, farmName, fruitName, status, startTime, endTime, weight, count</span>
          <span class="param-desc">å¯é€‰ï¼Œåªä¼ è¦ä¿®æ”¹çš„å­—æ®µ</span>
        </div>
      </div>

      <h3>è¯·æ±‚ç¤ºä¾‹ï¼ˆJSON Bodyï¼Œæ¨èï¼‰ï¼š</h3>
      <div class="example">
        <strong>JavaScript (fetch)ï¼š</strong>
        <pre>fetch('http://localhost:8080/api/processing/1', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    status: 'å·²å®Œæˆ',
    weight: 200
  })
})
  .then(res => res.json())
  .then(data => console.log('æ›´æ–°æˆåŠŸ:', data));</pre>
      </div>

      <div class="example">
        <strong>curlå‘½ä»¤ï¼š</strong>
        <pre>curl -X PUT http://localhost:8080/api/processing/1 \\
  -H "Content-Type: application/json" \\
  -d '{"status":"å·²å®Œæˆ","weight":200}'</pre>
      </div>
    </div>

    <div class="note" style="margin-top: 20px;">
      <strong>ğŸ’¡ å…¼å®¹æ—§ç‰ˆæœ¬ï¼š</strong> ä»æ”¯æŒ <code>POST /api/processing?action=update&id=1&...</code>
    </div>

    <h2>4ï¸âƒ£ åˆ é™¤åŠ å·¥è®°å½•ï¼ˆRESTful é£æ ¼ï¼‰</h2>
    <div class="api-item">
      <span class="method">DELETE</span>
      <span class="endpoint">/api/processing/:id</span>
      <p style="margin-top: 15px; color: #666;">åˆ é™¤æŒ‡å®šIDçš„åŠ å·¥è®°å½•</p>
      
      <h3>è·¯å¾„å‚æ•°ï¼š</h3>
      <div class="params">
        <div class="param-item">
          <span class="param-name">id</span>
          <span class="required">å¿…å¡«</span>
          <span class="param-desc">è®°å½•IDï¼ˆåœ¨URLè·¯å¾„ä¸­ï¼‰</span>
        </div>
      </div>

      <h3>è¯·æ±‚ç¤ºä¾‹ï¼š</h3>
      <div class="example">
        <strong>JavaScript (fetch)ï¼š</strong>
        <pre>fetch('http://localhost:8080/api/processing/1', {
  method: 'DELETE'
})
  .then(res => res.json())
  .then(data => console.log('åˆ é™¤æˆåŠŸ:', data));</pre>
      </div>

      <div class="example">
        <strong>curlå‘½ä»¤ï¼š</strong>
        <pre>curl -X DELETE http://localhost:8080/api/processing/1</pre>
      </div>
    </div>

    <div class="note" style="margin-top: 20px;">
      <strong>ğŸ’¡ å…¼å®¹æ—§ç‰ˆæœ¬ï¼š</strong> ä»æ”¯æŒ <code>POST /api/processing?action=delete&id=1</code>
    </div>

    <h2>5ï¸âƒ£ æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€</h2>
    <div class="api-item">
      <span class="method">GET</span>
      <span class="endpoint">/api/status</span>
      <p style="margin-top: 15px; color: #666;">æ£€æŸ¥HTTPæœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ</p>
      <pre>fetch('http://localhost:8080/api/status')
  .then(res => res.json())
  .then(data => console.log(data));</pre>
    </div>

    <div class="note" style="margin-top: 40px;">
      <strong>ğŸ“ æ³¨æ„äº‹é¡¹ï¼š</strong>
      <ul style="margin-top: 10px; margin-left: 20px;">
        <li>æ‰€æœ‰æ¥å£éƒ½è¿”å›JSONæ ¼å¼æ•°æ®</li>
        <li>æˆåŠŸæ—¶è¿”å› <code>{"ok": true, "data": [...]}</code></li>
        <li>å¤±è´¥æ—¶è¿”å› <code>{"ok": false, "message": "é”™è¯¯ä¿¡æ¯"}</code></li>
        <li>æ—¶é—´æ ¼å¼æ”¯æŒï¼š<code>2025-11-08T11:40</code> æˆ– <code>2025-11-08 11:40:00</code></li>
        <li>å¼€å§‹æ—¶é—´ä¸èƒ½æ™šäºç»“æŸæ—¶é—´</li>
        <li><strong>RESTful é£æ ¼ï¼š</strong> æ¨èä½¿ç”¨ GET/POST/PUT/DELETE æ–¹æ³•ï¼Œæ›´ç¬¦åˆæ ‡å‡†</li>
        <li><strong>åˆ†é¡µï¼š</strong> GET /api/processing æ”¯æŒ page å’Œ size å‚æ•°ï¼Œé»˜è®¤æ¯é¡µ20æ¡ï¼Œæœ€å¤š100æ¡</li>
        <li><strong>JSON Bodyï¼š</strong> POST/PUT è¯·æ±‚æ”¯æŒ JSON æ ¼å¼çš„è¯·æ±‚ä½“ï¼ŒContent-Type: application/json</li>
        <li><strong>å‘åå…¼å®¹ï¼š</strong> æ—§ç‰ˆæœ¬çš„ action å‚æ•°æ–¹å¼ä»ç„¶æ”¯æŒ</li>
      </ul>
    </div>
  </div>
</body>
</html>`;

    return HttpResponseUtils.buildHtmlResponse(htmlContent);
  }
}


